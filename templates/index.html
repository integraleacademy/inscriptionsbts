{% extends "base.html" %}
{% block content %}

<div class="form-container">
  <h2>üìù Pr√©-inscriptions BTS 2026</h2>

  <div class="notice">
    <p>Vous allez compl√©ter votre dossier de pr√©-inscription pour int√©grer l‚Äôun de nos BTS √† partir de septembre 2026.</p>
    <ol>
      <li>Compl√©tez ce formulaire. Vous recevrez ensuite un <strong>accus√© de r√©ception</strong> avec votre num√©ro de dossier.</li>
      <li>Dans un d√©lai de 15 jours, nous √©tudierons votre dossier et vous recevrez notre <em>avis d‚Äôadmission</em>.</li>
      <li>En cas d‚Äôavis favorable, vous pourrez confirmer votre inscription en cliquant sur <strong>¬´ Je confirme mon inscription ¬ª</strong>.</li>
    </ol>
    <p class="help">Besoin d‚Äôaide ? <a href="https://assistance-alw9.onrender.com/" target="_blank">Cliquez ici</a> ou appelez le <strong>04 22 47 07 68</strong>.</p>
  </div>

  <form id="inscriptionForm" class="tabs-form" method="post" action="{{ url_for('submit') }}" enctype="multipart/form-data">
    <div class="tabs">
      <button type="button" data-tab="tab1" class="active">ü™™ Infos g√©n√©rales</button>
      <button type="button" data-tab="tab2">üéì Formation</button>
      <button type="button" data-tab="tab3">üß© Infos compl√©mentaires</button>
      <button type="button" data-tab="tab4">üí¨ Projet motiv√©</button>
      <button type="button" data-tab="tab5">üìé Pi√®ces justificatives</button>
    </div>

    <!-- ü™™ √âtape 1 -->
    <div id="tab1" class="tab active">
      <div class="grid">
        <label>Nom <input name="nom" required></label>
        <label>Pr√©nom <input name="prenom" required></label>
        <label>Sexe
          <select name="sexe" required>
            <option value="">‚Äî</option>
            <option>Homme</option>
            <option>Femme</option>
          </select>
        </label>
        <label>Date de naissance <input type="date" name="date_naissance" required></label>
        <label>Ville de naissance <input name="ville_naissance" required></label>
        <label>Code postal de naissance <input name="cp_naissance" required></label>
        <label>Pays de naissance <input name="pays_naissance" required></label>
        <label>Num√©ro de s√©curit√© sociale <input name="num_secu" pattern="\d{15}" required></label>
        <label>Email <input type="email" name="email" required></label>
        <label>Confirmer l‚Äôemail <input type="email" name="email_confirm" required></label>
        <label>T√©l√©phone portable <input name="tel" pattern="\d{10}" required></label>
        <label>Adresse postale <input name="adresse" required></label>
        <label>Code postal <input name="cp" required></label>
        <label>Ville <input name="ville" required></label>
      </div>
      <div class="actions">
        <button type="button" class="btn primary next">√âtape suivante ‚û°Ô∏è</button>
      </div>
    </div>

    <!-- üéì √âtape 2 -->
<div id="tab2" class="tab">
  <label>Formation souhait√©e
    <select name="bts" required>
      <option value="">‚Äî</option>
      <option value="MOS">BTS MOS (S√©curit√©)</option>
      <option value="MCO">BTS MCO</option>
      <option value="PI">BTS PI</option>
      <option value="CI">BTS CI</option>
      <option value="NDRC">BTS NDRC</option>
      <option value="CG">BTS Comptabilit√©-Gestion</option>
    </select>
  </label>
  <label>Modalit√©
    <select name="mode" required>
      <option value="">‚Äî</option>
      <option value="presentiel">Pr√©sentiel (Puget-sur-Argens)</option>
      <option value="distanciel">100% √† distance (visioconf√©rence)</option>
    </select>
  </label>

  <!-- üü° Bloc sp√©cifique BTS MOS S√©curit√© -->
  <div id="mos-section" class="mos" style="display:none; margin-top:20px;">
    <h4>√Ä cocher, une seule case possible :</h4>
    <label><input type="radio" name="mos_situation" value="bac_titulaire"> Je suis titulaire d‚Äôun Bac Pro MS m√©tiers de la s√©curit√©</label><br>
    <label><input type="radio" name="mos_situation" value="bac_en_cours"> Je passe mon Bac Pro MS m√©tiers de la s√©curit√© en 2026</label><br>
    <label><input type="radio" name="mos_situation" value="carte_cnaps"> Je suis d√©j√† titulaire d‚Äôune carte professionnelle CNAPS</label><br>
    <label><input type="radio" name="mos_situation" value="autre"> Aucun de ces cas (bac g√©n√©ral, bac technologique, bac pro hors MS, autre)</label>

    <div id="mos-explication" style="display:none; margin-top:15px; background:#fff8e1; padding:15px; border-left:4px solid #f4c45a; border-radius:8px;">
      <p>
        Pour acc√©der √† notre <strong>BTS Management Op√©rationnel de la S√©curit√© (MOS)</strong>, vous devez √™tre titulaire d'une
        <strong>carte professionnelle ‚Äúagent de s√©curit√© priv√©e‚Äù</strong> d√©livr√©e par le Minist√®re de l'int√©rieur (CNAPS).
      </p>
      <p>
        En effet, la carte professionnelle vous sera r√©clam√©e dans le cadre de la recherche d'une entreprise de s√©curit√© priv√©e pour votre alternance.
      </p>
      <p>
        ‚û°Ô∏è <a href="https://www.canva.com/design/DAFyt9PCLzk/crHFPARJiocR1wDYdodMJw/view?utm_content=DAFyt9PCLzk&utm_campaign=designshare&utm_medium=link&utm_source=editor"
        target="_blank" style="color:#007bff; font-weight:600;">Plus d‚Äôinfos sur le CNAPS ici</a>
      </p>
      <p>
        Cette formation est propos√©e au tarif <strong>950 ‚Ç¨ (apprenti)</strong> au lieu de 1650 ‚Ç¨.  
        Le ch√®que sera √† envoyer par courrier lorsque nous aurons confirm√© votre inscription (encaiss√© le 1er jour de formation).
      </p>

      <p><strong>Veuillez cocher une des options suivantes :</strong></p>
      <label><input type="radio" name="mos_formation" value="session1"> Je souhaite m‚Äôinscrire √† la formation agent de s√©curit√© priv√©e pr√©vue du 8 juillet au 12 ao√ªt 2026  
      (lieu : Int√©grale Academy ‚Äì 54 chemin du Carreou 83480 Puget-sur-Argens)</label><br>
      <label><input type="radio" name="mos_formation" value="session2"> Je souhaite m‚Äôinscrire √† la formation agent de s√©curit√© priv√©e pr√©vue du 8 juillet au 12 ao√ªt 2026</label>
    </div>
  </div>

  <!-- Boutons d'√©tape -->
  <div class="actions">
    <button type="button" class="btn prev">‚¨ÖÔ∏è √âtape pr√©c√©dente</button>
    <button type="button" class="btn primary next">√âtape suivante ‚û°Ô∏è</button>
  </div>
</div>



    <!-- üß© √âtape 3 -->
    <div id="tab3" class="tab">
      <div class="grid">
        <label>Baccalaur√©at
          <select name="bac_status" required>
            <option value="">‚Äî</option>
            <option>Oui</option>
            <option>Non</option>
            <option>Pr√©vu en 2026</option>
          </select>
        </label>
        <label>Type de bac
          <select name="bac_type">
            <option value="">‚Äî</option>
            <option>G√©n√©ral</option>
            <option>Technologique</option>
            <option>Professionnel</option>
            <option>Autre</option>
          </select>
        </label>
        <label>Si ‚ÄúAutre‚Äù, pr√©ciser <input name="bac_autre"></label>
        <label>Permis B
          <select name="permis_b">
            <option value="">‚Äî</option>
            <option>Oui</option>
            <option>Non</option>
          </select>
        </label>
      </div>

      <div class="actions">
        <button type="button" class="btn prev">‚¨ÖÔ∏è √âtape pr√©c√©dente</button>
        <button type="button" class="btn primary next">√âtape suivante ‚û°Ô∏è</button>
      </div>
    </div>

    <!-- üí¨ √âtape 4 -->
    <div id="tab4" class="tab">
      <label>Pourquoi souhaitez-vous int√©grer ce BTS ?
        <textarea name="projet_pourquoi" rows="4" required></textarea>
      </label>
      <label>Quel est votre projet professionnel ?
        <textarea name="projet_objectif" rows="4" required></textarea>
      </label>
      <label>Quelles sont vos passions ?
        <textarea name="projet_passions" rows="4" required></textarea>
      </label>

      <div class="actions">
        <button type="button" class="btn prev">‚¨ÖÔ∏è √âtape pr√©c√©dente</button>
        <button type="button" class="btn primary next">√âtape suivante ‚û°Ô∏è</button>
      </div>
    </div>

    <!-- üìé √âtape 5 -->
    <div id="tab5" class="tab">
      <div class="grid">
        <label>Carte d‚Äôidentit√© / Passeport (1 fichier obligatoire) <input type="file" name="ci" accept="application/pdf,image/*" required></label>
        <label>Deuxi√®me page / verso (facultatif) <input type="file" name="ci2" accept="application/pdf,image/*"></label>
        <label>Photo d‚Äôidentit√© <input type="file" name="photo" accept="image/*" required></label>
        <p class="photo-exemple">
          <img src="{{ url_for('static', filename='img/photo-exemple.png') }}" alt="Exemples de photos" style="max-width:280px;border-radius:8px;">
          <br><small>‚úÖ Photo nette, fond neutre ‚Äî ‚ùå Pas de selfie ni d‚Äôarri√®re-plan visible</small>
        </p>
        <label>Carte Vitale (PDF uniquement) <input type="file" name="carte_vitale" accept="application/pdf" required></label>
        <label>CV (PDF) <input type="file" name="cv" accept="application/pdf" required></label>
        <label>Lettre de motivation (PDF) <input type="file" name="lm" accept="application/pdf" required></label>
      </div>
      <div class="actions">
        <button type="button" class="btn prev">‚¨ÖÔ∏è √âtape pr√©c√©dente</button>
        <button class="btn primary" type="submit">‚úÖ Envoyer ma pr√©-inscription</button>
      </div>
    </div>

    <script>
// --- Afficher automatiquement la section MOS ---
const btsSelect = document.querySelector('select[name="bts"]');
const mosSection = document.getElementById('mos-section');
const mosExplication = document.getElementById('mos-explication');

if (btsSelect) {
  btsSelect.addEventListener('change', () => {
    if (btsSelect.value === 'MOS') {
      mosSection.style.display = 'block';
    } else {
      mosSection.style.display = 'none';
      mosExplication.style.display = 'none';
      document.querySelectorAll('input[name="mos_situation"]').forEach(r => r.checked = false);
    }
  });
}

// --- Si "Aucun de ces cas" est coch√©, afficher l‚Äôexplication ---
document.addEventListener('change', (e) => {
  if (e.target.name === 'mos_situation') {
    if (e.target.value === 'autre') {
      mosExplication.style.display = 'block';
    } else {
      mosExplication.style.display = 'none';
    }
  }
});
</script>

  </form>
</div>

{% endblock %}
